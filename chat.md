# VoidWorld — История диалога разработки

## Начальные требования (исходный текст)

У меня есть идея для проекта. Необходимо оценить и реализовать шаблон проекта одиночной игры.  ГГ просыпается на острове после кораблекрушения, он ничего не помнит, лишь фрагменты его прошлой жизни, он не помнит кто он и как попал на корабль. Он плыл нелегально, во время кораблекрушения его выкинуло на берег. Это неизвестный остров, он пробирается через джунгли и пещеру и выходит в долину. Он проходит долину и заходит в деревню. В деревне он узнает, что происходят загадочные события, пропал король и столицу закрыли. В деревне гг делает несколько заданий и идет в столицу. Столица представляет собой средневековый город-крепость на берегу залива. В центре города находится устремившийся в небо замок, части которого летают, без магии это невозможно, вершина замка окутана черными облаками. Иногда сверху доносятся звуки, похожие на взрывы. Поговаривают, что иногда бывают демонические крики. Герою удается попасть в замок. В замке он выполняет задания рандомных людей и в один момент он видит группу хорошо вооруженных наёмников, при разговоре с ними они берут его в замок. Там гг узнает, что город закрыт из-за того, что король был ученым и разрабатывал способы получения энергии из пустоты и в ходе экспериментов он создал ложный вакуум, наша вселенная начала объединяться с другой, в нашей вселенной начали появляться точки другой вселенной, в которой победил ложный вакуум, который стирает всё бытие. Из-за этого наша вселенная тоже будет стёрта полностью. Но король успел наложить заклинание, которое консервирует точки соприкосновения вселенных, путём изменения скорости расширения пространства в этих точках таким образом, что пространство там сужается с такой скоростью, что временно купирует скорость расширения ложного вакуума другой вселенной. Король находится в промежуточном состоянии, его сил осталось только на то, чтобы поддерживать это заклинание. Герой начинает работу по расследованию того, как можно избежать катастрофы и с продолжением исследования понимает, что в короля попало что то из той Вселенной. Он использует на короле заклинание слово мертвеца. И понимает, что это бог - душа той мертвой Вселенной застрял внутри короля и сдерживает дыры этого ложного вакуума. И мы начинаем работать с этим богом, чтобы остановить это. Мы добираемся до верхних этажей башни, попутно ведя своё собственное расследование и понимаем масштабы экспериментов, та вселенная проникла в нашу ещё до падания и мы понимаем, что тот бог не такой уж и хороший. В процессе мы телепортируемся на космическую платформу короля за великим аттрактором, магией ограниченную от вакуума, сражаемся с демонами из той вселенной и находим поразительные вещи. Вселенная, являясь другим существом богом поглощает сознания и собирает всё сознательное в свои капсулы, питаясь этим. После мы попадаем на планету, полностью состоящую из материального сознания, но замороженного. Мы путешествуем по планете, части которой говорят с нами. В итоге нам необходимо сделать выборы. Дать объединить вселенные и создать единое огромное сознание, что поместит нас в симуляцию, отправив ложный вакуум в бесконечное уменьшающиеся пространство, создав тот же мир, но в симуляции. Дать поглотить все вселенные ложным вакуумом, бесконечно поедающим всё межвселенское пространство и бытие. Заморозить всё как есть. Договориться с тем богом и поместить его в созданное тело и освободить короля.

Предыстория гг выбирается самим игроком в начале путём выбора вариантов из дерева вариантов.

Игра является модом на майнкрафт, поэтому можно разбирать все дома, строить что угодно. Но за разрушение блоков города полагается штрафы и тюрьма, из которой можно сбегать.

В игре будет система донатов на дальнейшие проекты из этой вселенной.

Бог мертвой Вселенной может создавать клоны существ, которые временно могут помогать гг в различных задачах. Можно создать своё призываемое существо и использовать его. Оно создается получением частички уцелевшего сознания из той вселенной. Игрок может кастомизировать существо, добавляя ему качества и умения.

Гг сможет построить себе дом либо в городе на спец участке, который может курить близко к торговле и заданиям, либо получить участок свободный, либо жить в лесах.

Будет несколько городов в игре с разными биомами. Готический город, где можно отыгрывать вампира, лазать по крышам, прятаться, пить кровь. Пустынный город как лут голейн. Снежный город крепость в горах. Болотистый город. Кампания на островах, куда можно ездить за артефактами, где затонули остальные корабли на которых плыл гг, там основали пиратскую бухту. Подводная кампания. В разных частях мира будут дыры из другой вселенной, где будут существа, части которых можно использовать в питомце. 

Задания.
Есть план здания. Необходимо выполнить секретную миссию, передвигаясь скрытно по крышам.

Перехват линии агрессивных огромных Жуков из другой вселенной.

Примирение с агрессивными человеко гиенами разбойниками.

Уничтожение эпицентров зомби вируса. В конце уничтожение зомби планеты.

Игровой банк куда можно класть деньги.

Сторонние эвенты и возможности:
Задания на программирование.
Задания на комбинаторику.
На разбор загадок.
Приручение магических и обычных существ.  Почти всё сознание однозначно агрессивных существ из той вселенной контролируется церебралами-генералами мозга вражеского мага, они являются зомби без сознания, чтобы при прохождении игры игрок мог пройти игру вынужденно не убив ни одного существа. У этого будет своя кампания.

Будет часть карты с летающими островами, где тоже можно строить дом и мосты между ними. У островов будет своя кампания.  Часть карты в стиле венеции и италии, этот город был затоплен, но жители по религиозным причинам остались и стали строить дома на воде, тк выгодных торговый маршрут. У города будет своя кампания.  Игру планируется реализовать как мод или плагин на сервер майнкрафта. Будут неразрушаемые или тяжело разрушаемые зоны.

Из главного города будут миссии по закрытию точек ложного вакуума той вселенной, чтобы вести игрока в разные части карты.

Версия майнкрафта 1.20.1

---

## Решение 1: Выбор технологий

**Вопрос:** Какой фреймворк, размер команды, язык?

**Ответ:**
- Фреймворк: **Forge**
- Команда: **Соло-разработчик**
- Язык: **Kotlin + Java** (Kotlin для логики, Java где нужна совместимость)

---

## Решение 2: План и оценка проекта

### Оценка масштаба
- Проект уровня full-scale RPG внутри Minecraft (сравним с TerraFirmaCraft, Advent of Ascension)
- Для одного разработчика реалистичный срок: **1.5-3 года**
- Рекомендация: вертикальный срез (кораблекрушение → столица) как MVP

### Технологический стек
| Компонент | Версия |
|---|---|
| Minecraft | 1.20.1 |
| Forge | 47.4.16 |
| KotlinForForge | 4.11.0 |
| Java | 17 |
| Kotlin | 2.0.0 |
| Gradle | 8.7 |
| Mappings | Parchment 2023.09.03-1.20.1 |

---

## Реализация 1: Шаблон проекта (initial scaffold)

### Созданные файлы (56 файлов, 5432 строки)

#### Gradle и сборка
- `build.gradle` — Forge 47.4.16 + KotlinForForge 4.11.0 + Parchment + Kotlin Serialization
- `gradle.properties` — все переменные мода
- `settings.gradle` — репозитории плагинов
- `gradlew`, `gradlew.bat`, `gradle/wrapper/` — Gradle Wrapper 8.7

#### Ядро мода
- `VoidWorldMod.java` — точка входа @Mod с инициализацией всех систем
- `ModRegistries.kt` — DeferredRegister для блоков, предметов, сущностей, звуков, меню, креативных табов
- `ModNetwork.kt` — SimpleChannel с утилитами отправки пакетов
- `ModConfig.kt` — ForgeConfigSpec (common + client) с настройками всех систем
- `ModEvents.kt` — обработчики Forge-событий (join, death, block break, server start/stop)
- `PlayerVoidData.kt` — Capability для хранения данных игрока
- `Extensions.kt` — Kotlin-утилиты (ResourceLocation, Component, BlockPos, NBT DSL, Player)

#### Интерфейсы игровых систем
- `IQuest.kt` + `QuestManager.kt` — квесты с этапами, целями, категориями
- `IDialog.kt` — диалоговые деревья с условиями и действиями
- `INpc.kt` — NPC с ролями, торговлей, расписанием
- `IEconomy.kt` + `BankManager.kt` — экономика с банком, штрафами, трансферами
- `ILawSystem.kt` — закон, защищённые зоны, тюрьма
- `IStealthSystem.kt` — стелс с видимостью, уровнями тревоги
- `ISummon.kt` — призываемые существа с формами и способностями
- `IBackstoryNode.kt` — дерево предыстории с категориями
- `IPuzzle.kt` — головоломки (программирование, комбинаторика, загадки)
- `DonationIntegration.kt` — система донатов

#### Ресурсы
- `mods.toml` — метаданные мода с зависимостью от kotlinforforge
- `pack.mcmeta`
- `en_us.json` / `ru_ru.json` — локализация всех систем и 15+ локаций
- `sounds.json`
- Примеры data-driven: `example_quest.json`, `example_dialog.json`, `example_npc.json`

#### Документация
- `README.md` — описание, стек, инструкция по запуску, структура
- `docs/GDD.md` — полный Game Design Document (сюжет, 6 актов, 4 концовки, 13 локаций)
- `docs/ROADMAP.md` — план разработки из 6 фаз с чеклистами

#### Структура пакетов — 78 директорий
```
core/ (registry, network, config, data, event, util, command)
system/ (quest, npc, economy, housing, law, stealth, summon, backstory, puzzle, donation)
entity/ (npc, creature, voidborn, summon, boss)
block/ (decoration, functional, protectedzone, voidcrack)
item/ (weapon, artifact, quest, consumable, tool)
world/ (biome, structure, dimension, feature, location, gen)
client/ (gui, hud, render, model, sound)
api/
```

---

## Решение 3: Фиксированные карты и кастомное меню

**Вопрос:** Как лучше реализовать фиксированные карты для каждого измерения с разметкой на скриптованные локации? Можно ли изменить главное меню?

**Ответ:** Да, оба реализуемы.

### Реализация: Location Registry (4 файла)
- `GameLocation.kt` — модель локации с 14 типами (CITY, DISTRICT, BUILDING, DUNGEON, VOID_CRACK, HOUSING_PLOT и т.д.)
- `LocationRegistry.kt` — реестр с chunk-based пространственным индексом, загрузка из JSON
- `LocationTracker.kt` — отслеживание входа/выхода из локаций каждые 0.5 сек, уведомления
- `LocationDebugWand.kt` — debug-инструмент для разметки прямо в игре

### Реализация: World Template System (3 файла)
- `VoidWorldChunkGenerator.kt` — void-генератор (пустые чанки за пределами карты)
- `WorldTemplateManager.kt` — копирует pre-built .mca файлы из worldtemplate/ в save
- `ModDimensions.kt` — определения кастомных измерений (Космическая Платформа, Планета Сознания)

### Реализация: Кастомное главное меню (1 файл)
- `VoidWorldTitleScreen.kt` — кнопка "Войти в VoidWorld" / "Продолжить VoidWorld" на TitleScreen

### Dimension data packs
- `dimension_type/cosmic_platform.json` — тёмное небо, фиксированная ночь
- `dimension_type/consciousness_planet.json` — вечные сумерки
- `dimension/cosmic_platform.json`, `dimension/consciousness_planet.json` — void-генератор

---

## Решение 4: Bootstrap-разметка мира

**Вопрос:** Можно ли создать заготовку с пустыми мирами, где схематично обведены блоками все локации?

**Ответ:** Да, через in-game команду.

### Реализация: WorldBootstrapper (3 файла)

- `BootstrapLocations.kt` — раскладка 39 локаций с координатами по 3 измерениям
- `WorldBootstrapper.kt` — размещает платформы, границы, столбы, таблички
- `ModCommands.kt` — полное дерево команд `/vw`

### Раскладка overworld
```
              N (-Z)
                |
   Aquaverde    |    Pirate Cove
   (0,-1200)    |    (-1800,-800)
                |
             Village
            (-400,-400)
W ———— THE CAPITAL (0,0) ———— E
             (center)
   Frosthold    |    Nocturn
  (-1200,800)   |   (1200,200)
                |
   Mirewood     |    Sandport
  (-600,1200)   |   (800,1200)
                |
              S (+Z)

Shipwreck Island: (-2200, -1800)  далеко на СЗ
Floating Islands: над столицей, Y=150
Void Cracks: разбросаны по карте (3 шт.)
```

### Цветовая схема границ по типу
| Тип | Пол | Граница |
|---|---|---|
| CITY | Stone Bricks | Red Concrete |
| DISTRICT | Smooth Stone | Orange Concrete |
| BUILDING | Polished Andesite | Yellow Concrete |
| DUNGEON | Deepslate Bricks | Purple Concrete |
| WILDERNESS | Grass Block | Green Concrete |
| VOID_CRACK | Obsidian | Black Concrete |
| TELEPORT_POINT | End Stone Bricks | Cyan Concrete |
| SPAWN_ZONE | Netherrack | Red Nether Bricks |

### Команды `/vw`
| Команда | Описание |
|---|---|
| `/vw world bootstrap` | Разметить все измерения |
| `/vw world bootstrap overworld` | Разметить только overworld |
| `/vw location list` | Список всех локаций |
| `/vw location info` | Какие локации на текущей позиции |
| `/vw location tp voidworld:capital` | Телепорт в локацию |
| `/vw location create <id> <type>` | Создать локацию из wand-выделения |
| `/vw location export` | Экспорт всех локаций в JSON |

---

## Запуск проекта

```bash
# Сгенерировать run-конфигурации (один раз)
./gradlew genIntellijRuns

# Запустить клиент Minecraft с модом
./gradlew runClient

# Запустить сервер
./gradlew runServer

# Собрать JAR
./gradlew build
```

---

## Git

- Репозиторий: https://github.com/nulnow/voidworld
- Коммит: `4092a80` — Initial project scaffold
- 56 файлов, 5432 строки кода
